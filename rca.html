<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spiritual Root Cause Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%);
            min-height: 100vh;
            line-height: 1.6;
            color: #1e293b;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header-icon {
            background: linear-gradient(135deg, #4c1d95 0%, #5b21b6 50%, #6b21a8 100%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 0 8px 32px rgba(75, 29, 149, 0.3);
        }

        .header h1 {
            color: #1e293b;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #4c1d95 0%, #6b21a8 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: #475569;
            max-width: 600px;
            margin: 0 auto;
            font-size: 1.1rem;
            font-weight: 400;
        }

        .input-section {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 28px;
            margin-bottom: 28px;
        }

        .input-label {
            display: block;
            font-weight: 600;
            color: #334155;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .input-textarea {
            width: 100%;
            height: 120px;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            resize: none;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #ffffff;
        }

        .input-textarea:focus {
            outline: none;
            border-color: #6b21a8;
            box-shadow: 0 0 0 3px rgba(107, 33, 168, 0.1);
            background: #fefefe;
        }

        .analyze-button {
            background: linear-gradient(135deg, #4c1d95 0%, #5b21b6 50%, #6b21a8 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            margin-top: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(75, 29, 149, 0.3);
        }

        .analyze-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(75, 29, 149, 0.4);
        }

        .analyze-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .analysis-section {
            display: none;
            animation: fadeIn 0.6s ease-in;
        }

        .analysis-section.show {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .analysis-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            border-left: 4px solid;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
        }

        .root-cause {
            border-left-color: #dc2626;
            background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
        }

        .sentence-breakdown {
            border-left-color: #0891b2;
            background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
        }

        .identifications {
            border-left-color: #ea580c;
            background: linear-gradient(135deg, #fff7ed 0%, #ffffff 100%);
        }

        .insights {
            border-left-color: #4c1d95;
            background: linear-gradient(135deg, #f3f4f6 0%, #ffffff 100%);
        }

        .temporary {
            border-left-color: #ca8a04;
            background: linear-gradient(135deg, #fefce8 0%, #ffffff 100%);
        }

        .eternal {
            border-left-color: #059669;
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
        }

        .practice {
            border-left-color: #7c3aed;
            background: linear-gradient(135deg, #faf5ff 0%, #ffffff 100%);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }

        .card-icon {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .root-cause .card-title { color: #dc2626; }
        .sentence-breakdown .card-title { color: #0891b2; }
        .identifications .card-title { color: #ea580c; }
        .insights .card-title { color: #4c1d95; }
        .temporary .card-title { color: #ca8a04; }
        .eternal .card-title { color: #059669; }
        .practice .card-title { color: #7c3aed; }

        .breakdown-item {
            background: rgba(8, 145, 178, 0.08);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(8, 145, 178, 0.15);
        }

        .breakdown-text {
            font-weight: 600;
            color: #0891b2;
            font-size: 1.05rem;
            margin-bottom: 8px;
        }

        .breakdown-analysis {
            color: #0e4f5c;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .identification-item {
            background: rgba(234, 88, 12, 0.08);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(234, 88, 12, 0.15);
        }

        .identification-category {
            font-weight: 600;
            color: #ea580c;
            font-size: 1.05rem;
            margin-bottom: 6px;
        }

        .identification-details {
            font-size: 0.95rem;
            color: #9a3412;
            line-height: 1.4;
        }

        .insight-item {
            background: rgba(76, 29, 149, 0.08);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(76, 29, 149, 0.15);
        }

        .insight-text {
            color: #4c1d95;
            font-size: 1rem;
            line-height: 1.5;
            font-weight: 500;
        }

        .eternal-reminder {
            background: rgba(5, 150, 105, 0.08);
            padding: 18px;
            border-radius: 12px;
            margin-top: 16px;
            border: 1px solid rgba(5, 150, 105, 0.15);
        }

        .eternal-list {
            list-style-type: none;
            padding-left: 0;
            margin-top: 12px;
        }

        .eternal-list li {
            color: #059669;
            font-size: 0.95rem;
            margin-bottom: 8px;
            padding-left: 24px;
            position: relative;
            line-height: 1.4;
        }

        .eternal-list li:before {
            content: "â€¢";
            font-weight: bold;
            position: absolute;
            left: 0;
            color: #10b981;
            font-size: 1.2rem;
        }

        .practice-steps {
            list-style-type: decimal;
            padding-left: 24px;
            margin-top: 12px;
        }

        .practice-steps li {
            color: #7c3aed;
            margin-bottom: 10px;
            font-size: 1rem;
            line-height: 1.4;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #ffffff40;
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .highlight-false {
            background: linear-gradient(135deg, #fecaca 0%, #fee2e2 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .highlight-emotion {
            background: linear-gradient(135deg, #fed7aa 0%, #fef3c7 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .body-chain {
            background: rgba(220, 38, 38, 0.1);
            padding: 16px;
            border-radius: 12px;
            border: 1px solid rgba(220, 38, 38, 0.2);
            margin-top: 12px;
        }

        .chain-step {
            margin-bottom: 8px;
            color: #7f1d1d;
            font-weight: 500;
        }

        .ultimate-root {
            background: rgba(220, 38, 38, 0.15);
            padding: 12px;
            border-radius: 8px;
            margin-top: 8px;
            border: 2px solid rgba(220, 38, 38, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-icon">
                <svg width="24" height="24" fill="white" viewBox="0 0 24 24">
                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                </svg>
            </div>
            <h1>Spiritual Root Cause Analyzer</h1>
            <p>Discover how misidentification with temporary body, mind, and roles creates suffering.<br>
            Recognize your true nature as eternal, peaceful awareness.</p>
        </div>

        <div class="input-section">
            <label class="input-label" for="situation">Describe your situation or challenge:</label>
            <textarea 
                id="situation" 
                class="input-textarea" 
                placeholder="e.g., 'I am tall and that makes me happy' or 'I am recently divorced and feeling dejected' or 'I did not score well in recent exams and I am feeling dull and depressed'"
            ></textarea>
            <button id="analyzeBtn" class="analyze-button" onclick="analyzeSituation()">
                <span id="buttonText">Analyze Root Cause</span>
            </button>
        </div>

        <div id="analysisResults" class="analysis-section">
            <!-- Ultimate Root Cause -->
            <div class="analysis-card root-cause">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9l-6.91.74L12 16l-3.09-6.26L2 9l6.91-.74L12 2z"/>
                    </svg>
                    Ultimate Root Cause
                </h3>
                <p style="color: #dc2626; font-weight: 700; font-size: 1.2rem; margin-bottom: 12px;">
                    Wrong identification with the temporary body
                </p>
                <div id="bodyChain" class="body-chain"></div>
            </div>

            <!-- Sentence Breakdown -->
            <div class="analysis-card sentence-breakdown">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Sentence Analysis & False Associations
                </h3>
                <div id="sentenceBreakdown"></div>
            </div>

            <!-- Identifications -->
            <div id="identificationsCard" class="analysis-card identifications" style="display: none;">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                    </svg>
                    False Identity Categories
                </h3>
                <div id="identificationsList"></div>
            </div>

            <!-- Insights -->
            <div class="analysis-card insights">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 6.828a4 4 0 005.656 0l1.414-1.414a4 4 0 00-5.656-5.656l-1.414 1.414a4 4 0 000 5.656z"/>
                    </svg>
                    Spiritual Insights
                </h3>
                <div id="insightsList"></div>
            </div>

            <!-- Temporary Aspects -->
            <div class="analysis-card temporary">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Temporary Aspects (Not Your True Self)
                </h3>
                <ul id="temporaryList" style="list-style-type: disc; padding-left: 24px; color: #ca8a04;"></ul>
                <p style="color: #ca8a04; margin-top: 12px; font-style: italic; font-weight: 500;">
                    These are passing phenomena that come and go. They are not who you truly are.
                </p>
            </div>

            <!-- Eternal Truth -->
            <div class="analysis-card eternal">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                    </svg>
                    Your True Nature
                </h3>
                <p style="color: #059669; font-weight: 600; margin-bottom: 12px; font-size: 1.1rem;">
                    You are not the body. You are the eternal, pure soul - the consciousness that witnesses all body experiences.
                </p>
                <div class="eternal-reminder">
                    <p style="color: #059669; font-weight: 600; margin-bottom: 12px;">Essential Truth:</p>
                    <ul class="eternal-list">
                        <li>You are not the body - you are the consciousness that observes the body</li>
                        <li>You are not the mind - you are the awareness that witnesses thoughts and emotions</li>
                        <li>You are not your relationships - you are the eternal soul temporarily playing roles</li>
                        <li>You are not your circumstances - you are the unchanging witness of all changes</li>
                        <li>The body is transient and changing - you are the eternal, pure, peaceful soul</li>
                        <li>All suffering ends when you recognize: "I am not this body, I am pure consciousness"</li>
                    </ul>
                </div>
            </div>

            <!-- Practice -->
            <div class="analysis-card practice">
                <h3 class="card-title">
                    <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                    </svg>
                    Practice for Liberation
                </h3>
                <div style="color: #7c3aed;">
                    <p style="font-weight: 600; margin-bottom: 12px; font-size: 1.05rem;">When this situation arises again:</p>
                    <ol class="practice-steps">
                        <li>Pause and ask: "Who is experiencing this?"</li>
                        <li>Recognize: "I am not the body experiencing this - I am the consciousness witnessing it"</li>
                        <li>Detach from body-identification: "This is happening to the body-mind, not to my true self"</li>
                        <li>Rest in your true nature: "I am the eternal, pure soul - not this changing body"</li>
                        <li>Affirm: "The body is temporary, I am eternal consciousness"</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        var identificationTypes = [
            { 
                type: 'Physical Identity', 
                keywords: ['tall', 'short', 'body', 'appearance', 'looks', 'physical', 'age', 'health', 'sick', 'tired', 'strong', 'weak', 'beautiful', 'ugly', 'fat', 'thin', 'height', 'weight'],
                description: 'The fundamental error: identifying with the temporary, changing body instead of recognizing yourself as eternal consciousness'
            },
            { 
                type: 'Relational Identity', 
                keywords: ['divorced', 'married', 'single', 'partner', 'spouse', 'husband', 'wife', 'parent', 'son', 'daughter', 'mother', 'father', 'friend', 'relationship'],
                description: 'Identifying with temporary social relationships and family roles that exist because you think you are a body with relationships'
            },
            { 
                type: 'Professional Identity', 
                keywords: ['boss', 'employee', 'job', 'work', 'career', 'manager', 'colleague', 'business', 'office', 'project', 'meeting', 'salary'],
                description: 'Defining yourself through temporary professional roles that exist because you identify as a body-person in society'
            },
            { 
                type: 'Academic Identity', 
                keywords: ['exam', 'score', 'test', 'grade', 'study', 'student', 'school', 'college', 'university', 'education', 'learning'],
                description: 'Identifying with academic performance and student role - a temporary identity of the body-person in educational system'
            },
            { 
                type: 'Emotional Identity', 
                keywords: ['sad', 'angry', 'happy', 'depressed', 'anxious', 'excited', 'hurt', 'offended', 'proud', 'ashamed', 'feeling', 'emotion', 'dejected', 'dull'],
                description: 'Mistaking temporary emotional states as your permanent identity - emotions arise in the body-mind complex'
            },
            { 
                type: 'Achievement Identity', 
                keywords: ['investment', 'success', 'failure', 'accomplishment', 'goal', 'plan', 'idea', 'project', 'result', 'outcome', 'earned', 'million', 'rich', 'poor'],
                description: 'Identifying with temporary outcomes and achievements of the body-person in the material world'
            }
        ];

        var emotionWords = ['sad', 'angry', 'hurt', 'depressed', 'anxious', 'feeling', 'upset', 'frustrated', 'disappointed', 'lost', 'confused', 'worried', 'happy', 'excited', 'joyful', 'pleased', 'dejected', 'dull'];
        var identityPatterns = ['i am', 'i was', 'i have been', 'i feel like', 'i consider myself'];

        function generateBodyChain(situation) {
            var lowerSituation = situation.toLowerCase();
            var chain = [];
            
            // Physical body identification (direct)
            if (lowerSituation.indexOf('tall') !== -1 || lowerSituation.indexOf('short') !== -1 || 
                lowerSituation.indexOf('beautiful') !== -1 || lowerSituation.indexOf('ugly') !== -1 ||
                lowerSituation.indexOf('physical') !== -1 || lowerSituation.indexOf('body') !== -1) {
                
                chain.push("1. You identify with physical body characteristics (tall, appearance, etc.)");
                chain.push("2. Your emotions depend on these temporary body conditions");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body'");
                chain.push("TRUTH: You are the eternal consciousness observing the body, not the body itself");
            }
            
            // Relational identification (indirect through body)
            else if (lowerSituation.indexOf('divorced') !== -1 || lowerSituation.indexOf('married') !== -1 ||
                     lowerSituation.indexOf('son') !== -1 || lowerSituation.indexOf('daughter') !== -1) {
                
                chain.push("1. You identify with social relationship status (divorced, parent, etc.)");
                chain.push("2. These relationships exist only because you think you are a body with social connections");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body-person with relationships'");
                chain.push("TRUTH: You are the eternal soul temporarily playing social roles");
            }
            
            // Academic identification (indirect through body)
            else if (lowerSituation.indexOf('exam') !== -1 || lowerSituation.indexOf('score') !== -1 ||
                     lowerSituation.indexOf('test') !== -1 || lowerSituation.indexOf('grade') !== -1) {
                
                chain.push("1. You identify with academic performance and student role");
                chain.push("2. This student identity exists for the body-person in educational system");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body-person who studies/achieves'");
                chain.push("TRUTH: You are pure consciousness witnessing all learning experiences");
            }
            
            // Achievement identification (indirect through body)
            else if (lowerSituation.indexOf('business') !== -1 || lowerSituation.indexOf('earned') !== -1 ||
                     lowerSituation.indexOf('success') !== -1 || lowerSituation.indexOf('investment') !== -1) {
                
                chain.push("1. You identify with achievements and professional success");
                chain.push("2. These accomplishments belong to the body-person in the material world");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body-person who achieves'");
                chain.push("TRUTH: You are the eternal soul beyond all material gains and losses");
            }
            
            // Emotional identification (through body-mind)
            else if (lowerSituation.indexOf('happy') !== -1 || lowerSituation.indexOf('sad') !== -1 ||
                     lowerSituation.indexOf('depressed') !== -1 || lowerSituation.indexOf('dejected') !== -1 ||
                     lowerSituation.indexOf('dull') !== -1) {
                
                chain.push("1. You identify with emotional states (happy, sad, depressed, etc.)");
                chain.push("2. Emotions arise in the body-mind complex due to circumstances");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body-mind that feels emotions'");
                chain.push("TRUTH: You are the peaceful awareness in which all emotions arise and pass away");
            }
            
            // Default for any situation
            else {
                chain.push("1. You identify with temporary circumstances or conditions");
                chain.push("2. All temporary identities are based on believing you are the body-mind");
                chain.push("3. ULTIMATE ROOT CAUSE: Wrong identification 'I am this body-mind complex'");
                chain.push("TRUTH: You are eternal consciousness, not the temporary body-mind");
            }
            
            return chain;
        }

        function analyzeSentence(sentence) {
            var analysis = [];
            var lowerSentence = sentence.toLowerCase();
            
            // Find identity statements
            for (var i = 0; i < identityPatterns.length; i++) {
                var pattern = identityPatterns[i];
                var index = lowerSentence.indexOf(pattern);
                if (index !== -1) {
                    var remaining = sentence.substring(index + pattern.length).trim();
                    var falseIdentity = remaining.split(' and ')[0].split(' but ')[0].split(' because ')[0].trim();
                    
                    if (falseIdentity) {
                        var bodyConnection = "";
                        if (falseIdentity.indexOf('tall') !== -1 || falseIdentity.indexOf('physical') !== -1) {
                            bodyConnection = " This is direct body identification.";
                        } else if (falseIdentity.indexOf('divorced') !== -1 || falseIdentity.indexOf('student') !== -1) {
                            bodyConnection = " This temporary role exists because you identify as a body-person.";
                        }
                        
                        analysis.push({
                            type: 'false_identity',
                            original: pattern + ' ' + falseIdentity,
                            analysis: 'This shows identification with a temporary condition/role. You are not "' + falseIdentity + '" - you are the eternal consciousness observing this temporary situation.' + bodyConnection
                        });
                    }
                }
            }
            
            // Find emotional reactions
            for (var i = 0; i < emotionWords.length; i++) {
                var emotion = emotionWords[i];
                if (lowerSentence.indexOf(emotion) !== -1) {
                    analysis.push({
                        type: 'emotional_reaction',
                        original: emotion,
                        analysis: 'The emotion "' + emotion + '" is a temporary experience arising in the body-mind complex. You are not the emotion - you are the peaceful consciousness witnessing it without being affected.'
                    });
                }
            }
            
            // Find causal relationships
            if (lowerSentence.indexOf(' and ') !== -1) {
                var parts = sentence.split(' and ');
                if (parts.length >= 2) {
                    var cause = parts[0].trim();
                    var effect = parts[1].trim();
                    
                    analysis.push({
                        type: 'causal_belief',
                        original: sentence,
                        analysis: 'This shows the false belief that external circumstances ("' + cause + '") can determine your inner state ("' + effect + '"). This happens because you identify with the body-mind that can be affected by external changes. Your true nature as consciousness remains unaffected.'
                    });
                }
            }
            
            return analysis;
        }

        function analyzeIdentifications(text) {
            var lowerText = text.toLowerCase();
            var foundIdentifications = [];
            
            for (var i = 0; i < identificationTypes.length; i++) {
                var category = identificationTypes[i];
                var matches = [];
                
                for (var j = 0; j < category.keywords.length; j++) {
                    var keyword = category.keywords[j];
                    if (lowerText.indexOf(keyword.toLowerCase()) !== -1) {
                        matches.push(keyword);
                    }
                }
                
                if (matches.length > 0) {
                    foundIdentifications.push({
                        category: category.type,
                        matches: matches,
                        description: category.description
                    });
                }
            }
            
            return foundIdentifications;
        }

        function generateInsights(situation) {
            var insights = [];
            var lowerSituation = situation.toLowerCase();
            
            // Physical body situations
            if (lowerSituation.indexOf('tall') !== -1 || lowerSituation.indexOf('short') !== -1) {
                if (lowerSituation.indexOf('happy') !== -1) {
                    insights.push("Being happy about physical traits like height shows direct body identification. You feel good because you believe 'I am this tall body.' But you are not the body - you are the eternal consciousness that observes the body. Height is a temporary characteristic of the body you inhabit, not your true identity.");
                } else {
                    insights.push("Being affected by physical traits shows body identification. Physical characteristics are temporary attributes of the body. Your true self as pure consciousness is neither tall nor short - it is beyond all physical forms.");
                }
            }
            
            // Relationship situations
            else if (lowerSituation.indexOf('divorced') !== -1) {
                insights.push("Feeling dejected about divorce reveals identification with temporary social status. 'Divorced' is a label that applies to the body-person's legal/social situation. The suffering comes from thinking 'I am the divorced one' instead of recognizing yourself as the eternal soul that remains unchanged by relationship status. The body is transient - you are the eternal, pure soul.");
            }
            
            // Academic situations
            else if (lowerSituation.indexOf('exam') !== -1 || lowerSituation.indexOf('score') !== -1) {
                insights.push("Feeling depressed about exam results shows identification with the student role and academic performance. Both the 'student' identity and 'poor performance' affect the body-person's educational status. You suffer because you believe 'I am the student who failed.' Your true nature as pure consciousness is beyond all academic achievements or failures. The body goes to school - you are the eternal awareness witnessing the learning process.");
            }
            
            // Achievement situations
            else if (lowerSituation.indexOf('business') !== -1 || lowerSituation.indexOf('earned') !== -1) {
                insights.push("Emotions about business success or failure show identification with the achiever role. Material accomplishments affect the body-person's status in society. Whether rich or poor, successful or failed - these are temporary conditions of the body-person. You are the eternal soul that witnesses all material experiences without being touched by them.");
            }
            
            // Always add the fundamental body identification insight
            insights.push("All suffering ultimately stems from the primary misidentification: believing 'I am this body.' Whether it's physical traits, relationships, achievements, or emotions - they all affect the body-mind complex. The body is temporary and changing - you are the eternal, unchanging consciousness that witnesses the body and all its experiences. When you realize 'I am not this body, I am pure consciousness,' all suffering ends.");
            
            return insights;
        }

        function extractTemporaryAspects(situation) {
            var temporary = [];
            var lowerSituation = situation.toLowerCase();
            
            if (lowerSituation.indexOf('tall') !== -1 || lowerSituation.indexOf('physical') !== -1) {
                temporary.push("Physical body characteristics (height, appearance, strength)");
            }
            if (lowerSituation.indexOf('divorced') !== -1 || lowerSituation.indexOf('married') !== -1) {
                temporary.push("Social relationship status and legal labels");
            }
            if (lowerSituation.indexOf('exam') !== -1 || lowerSituation.indexOf('student') !== -1) {
                temporary.push("Academic performance and educational identity");
            }
            if (lowerSituation.indexOf('business') !== -1 || lowerSituation.indexOf('work') !== -1) {
                temporary.push("Professional roles and material achievements");
            }
            if (lowerSituation.indexOf('happy') !== -1 || lowerSituation.indexOf('sad') !== -1 || lowerSituation.indexOf('depressed') !== -1) {
                temporary.push("Emotional states and mental reactions");
            }
            
            if (temporary.length === 0) {
                temporary = ["The circumstances described", "The roles involved", "The emotional reactions"];
            }
            
            return temporary;
        }

        function analyzeSituation() {
            var situation = document.getElementById('situation').value.trim();
            if (!situation) return;

            var button = document.getElementById('analyzeBtn');
            var buttonText = document.getElementById('buttonText');
            
            button.disabled = true;
            buttonText.innerHTML = '<span class="loading-spinner"></span>Analyzing...';

            setTimeout(function() {
                var bodyChain = generateBodyChain(situation);
                var sentenceAnalysis = analyzeSentence(situation);
                var identifications = analyzeIdentifications(situation);
                var insights = generateInsights(situation);
                var temporaryAspects = extractTemporaryAspects(situation);

                // Show body identification chain
                var bodyChainElement = document.getElementById('bodyChain');
                var chainHtml = '';
                for (var i = 0; i < bodyChain.length; i++) {
                    if (bodyChain[i].indexOf('ULTIMATE ROOT CAUSE') !== -1) {
                        chainHtml += '<div class="ultimate-root"><strong>' + bodyChain[i] + '</strong></div>';
                    } else if (bodyChain[i].indexOf('TRUTH') !== -1) {
                        chainHtml += '<div class="ultimate-root" style="background: rgba(5, 150, 105, 0.15); border-color: rgba(5, 150, 105, 0.3); color: #059669;"><strong>' + bodyChain[i] + '</strong></div>';
                    } else {
                        chainHtml += '<div class="chain-step">' + bodyChain[i] + '</div>';
                    }
                }
                bodyChainElement.innerHTML = chainHtml;

                // Show sentence breakdown
                var sentenceBreakdown = document.getElementById('sentenceBreakdown');
                var breakdownHtml = '';
                
                if (sentenceAnalysis.length > 0) {
                    for (var i = 0; i < sentenceAnalysis.length; i++) {
                        var item = sentenceAnalysis[i];
                        breakdownHtml += '<div class="breakdown-item">';
                        breakdownHtml += '<div class="breakdown-text">';
                        
                        if (item.type === 'false_identity') {
                            breakdownHtml += '<span class="highlight-false">' + item.original + '</span>';
                        } else if (item.type === 'emotional_reaction') {
                            breakdownHtml += 'Emotional reaction: <span class="highlight-emotion">' + item.original + '</span>';
                        } else {
                            breakdownHtml += item.original;
                        }
                        
                        breakdownHtml += '</div>';
                        breakdownHtml += '<div class="breakdown-analysis">' + item.analysis + '</div>';
                        breakdownHtml += '</div>';
                    }
                } else {
                    breakdownHtml = '<div class="breakdown-item">';
                    breakdownHtml += '<div class="breakdown-analysis">This situation contains identification with temporary conditions that creates suffering by forgetting your true nature as pure consciousness beyond the body.</div>';
                    breakdownHtml += '</div>';
                }
                
                sentenceBreakdown.innerHTML = breakdownHtml;

                // Show identifications if found
                if (identifications.length > 0) {
                    document.getElementById('identificationsCard').style.display = 'block';
                    var identificationsList = document.getElementById('identificationsList');
                    var html = '';
                    
                    for (var i = 0; i < identifications.length; i++) {
                        var id = identifications[i];
                        html += '<div class="identification-item">';
                        html += '<div class="identification-category">' + id.category + '</div>';
                        html += '<div class="identification-details">' + id.description + '</div>';
                        html += '<div class="identification-details" style="margin-top: 8px;"><strong>Related words found:</strong> ' + id.matches.join(', ') + '</div>';
                        html += '</div>';
                    }
                    
                    identificationsList.innerHTML = html;
                }

                // Show insights
                var insightsList = document.getElementById('insightsList');
                var insightsHtml = '';
                for (var i = 0; i < insights.length; i++) {
                    insightsHtml += '<div class="insight-item">';
                    insightsHtml += '<div class="insight-text">' + insights[i] + '</div>';
                    insightsHtml += '</div>';
                }
                insightsList.innerHTML = insightsHtml;

                // Show temporary aspects
                var temporaryList = document.getElementById('temporaryList');
                var tempHtml = '';
                for (var i = 0; i < temporaryAspects.length; i++) {
                    tempHtml += '<li>' + temporaryAspects[i] + '</li>';
                }
                temporaryList.innerHTML = tempHtml;

                document.getElementById('analysisResults').classList.add('show');
                button.disabled = false;
                buttonText.textContent = 'Analyze Root Cause';
                
                setTimeout(function() {
                    document.getElementById('analysisResults').scrollIntoView();
                }, 100);
            }, 2000);
        }

        document.getElementById('situation').addEventListener('keypress', function(e) {
            if (e.keyCode === 13 && !e.shiftKey) {
                e.preventDefault();
                analyzeSituation();
            }
        });
    </script>
</body>
</html>